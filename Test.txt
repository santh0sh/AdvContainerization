function validateRefineWidgetForKms(form) {
    var $askKeywords = $("#askKeywords");
    if ($askKeywords.val().trim() === "") {
        alert("You must enter a keyword to complete this search.");
        return false;
    }

    // Capture start and end dates for each filter field
    var lastPublishedStartDate = $("#lastPublishedStartDate").val();
    var lastPublishedEndDate = $("#lastPublishedEndDate").val();
    var effectiveStartDate = $("#effectiveStartDate").val();
    var effectiveEndDate = $("#effectiveEndDate").val();
    var lastReviewedStartDate = $("#lastReviewedStartDate").val();
    var lastReviewedEndDate = $("#lastReviewedEndDate").val();

    // Helper function to add or update hidden fields in the form
    function addOrUpdateFilterField(fieldName, value) {
        var existingField = $("#" + fieldName);
        if (existingField.length === 0) {
            $('<input>').attr({
                type: 'hidden',
                id: fieldName,
                name: fieldName,
                value: value
            }).appendTo(form);
        } else {
            existingField.val(value);
        }
    }

    // Construct and add individual filters based on provided date ranges
    if (lastPublishedStartDate || lastPublishedEndDate) {
        var publishedDateRange = `[${lastPublishedStartDate ? `"${lastPublishedStartDate}T00:00:00Z"` : '*'} TO ${lastPublishedEndDate ? `"${lastPublishedEndDate}T23:59:59Z"` : '*'}]`;
        addOrUpdateFilterField('last_published_date', publishedDateRange);
    }
    if (effectiveStartDate || effectiveEndDate) {
        var effectiveDateRange = `[${effectiveStartDate ? `"${effectiveStartDate}T00:00:00Z"` : '*'} TO ${effectiveEndDate ? `"${effectiveEndDate}T23:59:59Z"` : '*'}]`;
        addOrUpdateFilterField('effective_date', effectiveDateRange);
    }
    if (lastReviewedStartDate || lastReviewedEndDate) {
        var reviewedDateRange = `[${lastReviewedStartDate ? `"${lastReviewedStartDate}T00:00:00Z"` : '*'} TO ${lastReviewedEndDate ? `"${lastReviewedEndDate}T23:59:59Z"` : '*'}]`;
        addOrUpdateFilterField('last_reviewed
